adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD105")
library(Seurat)
library(ggplot2)
library(patchwork)
library(dplyr)
library(biomaRt)
options(future.globals.maxSize = 4000 * 1024^2)
data <- as.sparse(read.table(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/GSE145491_UMIsMatrix.txt.gz",
sep = "", header = TRUE, row.names = 1))
library(Seurat)
library(ggplot2)
library(patchwork)
library(dplyr)
library(biomaRt)
options(future.globals.maxSize = 4000 * 1024^2)
data <- as.sparse(read.table(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/GSE145491_UMIsMatrix.txt.gz",
sep = "", header = TRUE, row.names = 1))
adtfeat <- c("CD9", "CD41", "CD48", "CD55", "CD105", "CD115", "CD135", "CD150", "CXCR4", "ESAM", "CD4")
adtmat <- data[adtfeat, ]
allfeat <- rownames(data)
rnafeat <- setdiff(allfeat, adtfeat)
rnamat <- data[rnafeat, ]
rm(data, adtfeat, allfeat)
seurat_object <- CreateSeuratObject(counts = rnamat)
seurat_object[["ADT"]] <- CreateAssay5Object(counts = adtmat)
rm(adtmat, rnamat, rnafeat)
Assays(seurat_object)
seurat_object <- NormalizeData(object = seurat_object, assay = "RNA")
seurat_object <- NormalizeData(object = seurat_object, assay = "ADT", method = "CLR")
FeatureScatter(seurat_object, feature1 = "adt_CD41", feature2 = "adt_CD105")
# List the current default assay
DefaultAssay(seurat_object)
#Change default assay
DefaultAssay(seurat_object) <- "RNA" #change it to either "RNA" or "ADT"
DefaultAssay(seurat_object)
Key(seurat_object[["RNA"]])
Key(seurat_object[["ADT"]])
seurat_object <- FindVariableFeatures(object = seurat_object)
seurat_object <- ScaleData(object = seurat_object)
seurat_object <- RunPCA(object =seurat_object)
seurat_object <- FindNeighbors(object =seurat_object, dims = 1:30)
seurat_object <- FindClusters(object =seurat_object)
seurat_object <- RunUMAP(object =seurat_object, dims = 1:30)
DimPlot(seurat_object)
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD105")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD105+ CD150+")
DimPlot(seurat_object)
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD41", feature2 = "adt_CD150")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD41-")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_150", feature2 = "adt_CD105")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD105")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD105+ CD150-")
DimPlot(seurat_object)
VlnPlot(seurat_object, "adt_ESAM")
adt_markers <- FindMarkers(seurat_object, ident.1 = "CD105+ CD150+", assay = "ADT")
rna_markers <- FindMarkers(seurat_object, ident.1 = "CD105+ CD150+", assay = "RNA")
write.csv(adt_markers, "C:/Users/rthalla//OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/adtmarkersgatetest.csv")
write.csv(rna_markers, "C:/Users/rthalla//OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkersgatetest.csv")
rna <- as.sparse(read.csv(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkersgatetest.csv", header = TRUE, row.names = 1))
rnanames <- rownames(rna)
ensembl <- useEnsembl(biomart = "genes")
listDatasets(ensembl)
mart <- useDataset("mmusculus_gene_ensembl", useMart("ensembl"))
gene_ids <- getBM(
filters = "ensembl_gene_id",
attributes = c("ensembl_gene_id", "mgi_symbol"),
values = rnanames,
mart = mart
)
id_list <- split(gene_ids[["mgi_symbol"]], gene_ids[["ensembl_gene_id"]])
rnaname <- character(nrow(rna))
for (i in seq_len(nrow(rna))) {
ensembl_id <- rownames(rna)[i]
if (ensembl_id %in% names(id_list)) {
rnaname[i] <- id_list[[ensembl_id]]
} else{
rnaname[i] <- ensembl_id
}
}
rnaname[rnaname == ""] <- NA
rownames(rna) <- rnaname
rm(ensembl, gene_ids, id_list, mart, ensembl_id, i, rnaname)
rownames(rna) <- make.names(rna, unique = TRUE)
rna <- as.sparse(read.csv(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkersgatetest.csv", header = TRUE, row.names = 1))
rnanames <- rownames(rna)
ensembl <- useEnsembl(biomart = "genes")
listDatasets(ensembl)
mart <- useDataset("mmusculus_gene_ensembl", useMart("ensembl"))
gene_ids <- getBM(
filters = "ensembl_gene_id",
attributes = c("ensembl_gene_id", "mgi_symbol"),
values = rnanames,
mart = mart
)
id_list <- split(gene_ids[["mgi_symbol"]], gene_ids[["ensembl_gene_id"]])
rnaname <- character(nrow(rna))
for (i in seq_len(nrow(rna))) {
ensembl_id <- rownames(rna)[i]
if (ensembl_id %in% names(id_list)) {
rnaname[i] <- id_list[[ensembl_id]]
} else{
rnaname[i] <- ensembl_id
}
}
rnaname[rnaname == ""] <- NA
rownames(rna) <- rnaname
rm(ensembl, gene_ids, id_list, mart, ensembl_id, i, rnaname)
write.csv(rna, "rnamarkergatetest_genename.csv")
rna <- as.sparse(read.csv(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkersgatetest.csv", header = TRUE, row.names = 1))
rnanames <- rownames(rna)
ensembl <- useEnsembl(biomart = "genes")
listDatasets(ensembl)
mart <- useDataset("mmusculus_gene_ensembl", useMart("ensembl"))
gene_ids <- getBM(
filters = "ensembl_gene_id",
attributes = c("ensembl_gene_id", "mgi_symbol"),
values = rnanames,
mart = mart
)
id_list <- split(gene_ids[["mgi_symbol"]], gene_ids[["ensembl_gene_id"]])
rnaname <- character(nrow(rna))
for (i in seq_len(nrow(rna))) {
ensembl_id <- rownames(rna)[i]
if (ensembl_id %in% names(id_list)) {
rnaname[i] <- id_list[[ensembl_id]]
} else{
rnaname[i] <- ensembl_id
}
}
rnaname[rnaname == ""] <- NA
rownames(rna) <- rnaname
rm(ensembl, gene_ids, id_list, mart, ensembl_id, i, rnaname)
write.csv(rna, "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkergatetest_genename.csv")
data <- as.sparse(read.table(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/GSE145491_UMIsMatrix.txt.gz",
sep = "", header = TRUE, row.names = 1))
adtfeat <- c("CD9", "CD41", "CD48", "CD55", "CD105", "CD115", "CD135", "CD150", "CXCR4", "ESAM", "CD4")
adtmat <- data[adtfeat, ]
allfeat <- rownames(data)
rnafeat <- setdiff(allfeat, adtfeat)
rnamat <- data[rnafeat, ]
rm(data, adtfeat, allfeat)
seurat_object <- CreateSeuratObject(counts = rnamat)
seurat_object[["ADT"]] <- CreateAssay5Object(counts = adtmat)
rm(adtmat, rnamat, rnafeat)
Assays(seurat_object)
seurat_object <- NormalizeData(object = seurat_object, assay = "RNA")
seurat_object <- NormalizeData(object = seurat_object, assay = "ADT", method = "CLR")
FeatureScatter(seurat_object, feature1 = "adt_CD41", feature2 = "adt_CD105")
# List the current default assay
DefaultAssay(seurat_object)
#Change default assay
DefaultAssay(seurat_object) <- "RNA" #change it to either "RNA" or "ADT"
DefaultAssay(seurat_object)
Key(seurat_object[["RNA"]])
Key(seurat_object[["ADT"]])
seurat_object <- FindVariableFeatures(object = seurat_object)
seurat_object <- ScaleData(object = seurat_object)
seurat_object <- RunPCA(object =seurat_object)
seurat_object <- FindNeighbors(object =seurat_object, dims = 1:30)
seurat_object <- FindClusters(object =seurat_object)
seurat_object <- RunUMAP(object =seurat_object, dims = 1:30)
DimPlot(seurat_object)
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD135")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD105+ CD150+")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_ESAM", feature2 = "adt_CD135")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD135+ CD150+")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_ESAM", feature2 = "adt_CD135")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD135+ ESAM-")
DimPlot(seurat_object)
adt_markers <- FindMarkers(seurat_object, ident.1 = "CD135+ ESAM-", ident.2 = "CD135- ESAM+", assay = "ADT")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_ESAM", feature2 = "adt_CD135")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD135- ESAM+")
DimPlot(seurat_object)
adt_markers <- FindMarkers(seurat_object, ident.1 = "CD135+ ESAM-", ident.2 = "CD135- ESAM+", assay = "ADT")
rna_markers <- FindMarkers(seurat_object, ident.1 = "CD135+ ESAM-", ident.2 = "CD135- ESAM+", assay = "RNA")
write.csv(adt_markers, "C:/Users/rthalla//OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/adtmarkersgatetest.csv")
write.csv(rna_markers, "C:/Users/rthalla//OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkersgatetest.csv")
rna <- as.sparse(read.csv(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkersgatetest.csv", header = TRUE, row.names = 1))
rnanames <- rownames(rna)
ensembl <- useEnsembl(biomart = "genes")
listDatasets(ensembl)
mart <- useDataset("mmusculus_gene_ensembl", useMart("ensembl"))
gene_ids <- getBM(
filters = "ensembl_gene_id",
attributes = c("ensembl_gene_id", "mgi_symbol"),
values = rnanames,
mart = mart
)
id_list <- split(gene_ids[["mgi_symbol"]], gene_ids[["ensembl_gene_id"]])
rnaname <- character(nrow(rna))
for (i in seq_len(nrow(rna))) {
ensembl_id <- rownames(rna)[i]
if (ensembl_id %in% names(id_list)) {
rnaname[i] <- id_list[[ensembl_id]]
} else{
rnaname[i] <- ensembl_id
}
}
rnaname[rnaname == ""] <- NA
rownames(rna) <- rnaname
rm(ensembl, gene_ids, id_list, mart, ensembl_id, i, rnaname)
write.csv(rna, "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnamarkergatetest_genename.csv")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD135")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD135- CD150low")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD135")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "MPP4")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD135")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "MPP3_1")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD48")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "MPP3_4")
seurat_object <- CreateSeuratObject(counts = rnamat)
data <- as.sparse(read.table(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/GSE145491_UMIsMatrix.txt.gz",
sep = "", header = TRUE, row.names = 1))
adtfeat <- c("CD9", "CD41", "CD48", "CD55", "CD105", "CD115", "CD135", "CD150", "CXCR4", "ESAM", "CD4")
adtmat <- data[adtfeat, ]
allfeat <- rownames(data)
rnafeat <- setdiff(allfeat, adtfeat)
rnamat <- data[rnafeat, ]
rm(data, adtfeat, allfeat)
seurat_object <- CreateSeuratObject(counts = rnamat)
seurat_object[["ADT"]] <- CreateAssay5Object(counts = adtmat)
rm(adtmat, rnamat, rnafeat)
Assays(seurat_object)
seurat_object <- NormalizeData(object = seurat_object, assay = "RNA")
FeatureScatter(seurat_object, feature1 = "adt_CD41", feature2 = "adt_CD105")
seurat_object <- CreateSeuratObject(counts = rnamat)
data <- as.sparse(read.table(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/GSE145491_UMIsMatrix.txt.gz",
sep = "", header = TRUE, row.names = 1))
adtfeat <- c("CD9", "CD41", "CD48", "CD55", "CD105", "CD115", "CD135", "CD150", "CXCR4", "ESAM", "CD4")
adtmat <- data[adtfeat, ]
allfeat <- rownames(data)
rnafeat <- setdiff(allfeat, adtfeat)
rnamat <- data[rnafeat, ]
rm(data, adtfeat, allfeat)
seurat_object <- CreateSeuratObject(counts = rnamat)
seurat_object[["ADT"]] <- CreateAssay5Object(counts = adtmat)
rm(adtmat, rnamat, rnafeat)
Assays(seurat_object)
seurat_object <- NormalizeData(object = seurat_object, assay = "RNA")
seurat_object <- NormalizeData(object = seurat_object, assay = "ADT", method = "RC")
FeatureScatter(seurat_object, feature1 = "adt_CD41", feature2 = "adt_CD105")
data <- as.sparse(read.table(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/GSE145491_UMIsMatrix.txt.gz",
sep = "", header = TRUE, row.names = 1))
adtfeat <- c("CD9", "CD41", "CD48", "CD55", "CD105", "CD115", "CD135", "CD150", "CXCR4", "ESAM", "CD4")
adtmat <- data[adtfeat, ]
allfeat <- rownames(data)
rnafeat <- setdiff(allfeat, adtfeat)
rnamat <- data[rnafeat, ]
rm(data, adtfeat, allfeat)
seurat_object <- CreateSeuratObject(counts = rnamat)
seurat_object[["ADT"]] <- CreateAssay5Object(counts = adtmat)
Assays(seurat_object)
seurat_object <- NormalizeData(object = seurat_object, assay = "RNA")
seurat_object <- NormalizeData(object = seurat_object, assay = "ADT", normalization.method = "RC")
FeatureScatter(seurat_object, feature1 = "adt_CD41", feature2 = "adt_CD105")
FeatureScatter(seurat_object, feature1 = "adt_CD41", feature2 = "adt_CD105", log = TRUE)
FeatureScatter(seurat_object, feature1 = "adt_CD48", feature2 = "adt_CD150", log = TRUE)
FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD48", log = TRUE)
FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD48", jitter = TRUE, log = TRUE)
FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_CD48", smooth = TRUE, log = TRUE)
FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM", log = TRUE)
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM")
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "MPP3_4")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM", log = TRUE)
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "MPP3_4")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM", log = TRUE)
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD150+ ESAM+")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM", log = TRUE)
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD150- ESAM-")
seurat_object <- FindVariableFeatures(object = seurat_object)
seurat_object <- ScaleData(object = seurat_object)
seurat_object <- RunPCA(object =seurat_object)
seurat_object <- FindNeighbors(object =seurat_object, dims = 1:30)
seurat_object <- FindClusters(object =seurat_object)
seurat_object <- RunUMAP(object =seurat_object, dims = 1:30)
DimPlot(seurat_object)
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM", log = TRUE)
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD150+ ESAM+")
adtscatter <- FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM", log = TRUE)
seurat_object <- CellSelector(adtscatter, object = seurat_object, ident = "CD150- ESAM-")
FeatureScatter(seurat_object, feature1 = "adt_CD150", feature2 = "adt_ESAM", log = TRUE)
adt_markers <- FindMarkers(seurat_object, ident.1 = "CD150+ ESAM+", ident.2 = "CD150- ESAM-", assay = "ADT")
rna_markers <- FindMarkers(seurat_object, ident.1 = "CD150+ ESAM+", ident.2 = "CD150- ESAM-", assay = "RNA")
write.csv(adt_markers, "C:/Users/rthalla//OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/adtcd150esam.csv")
write.csv(rna_markers, "C:/Users/rthalla//OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnacd150esam.csv")
rna <- as.sparse(read.csv(file = "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnacd150esam.csv", header = TRUE, row.names = 1))
rnanames <- rownames(rna)
ensembl <- useEnsembl(biomart = "genes")
listDatasets(ensembl)
mart <- useDataset("mmusculus_gene_ensembl", useMart("ensembl"))
gene_ids <- getBM(
filters = "ensembl_gene_id",
attributes = c("ensembl_gene_id", "mgi_symbol"),
values = rnanames,
mart = mart
)
id_list <- split(gene_ids[["mgi_symbol"]], gene_ids[["ensembl_gene_id"]])
rnaname <- character(nrow(rna))
for (i in seq_len(nrow(rna))) {
ensembl_id <- rownames(rna)[i]
if (ensembl_id %in% names(id_list)) {
rnaname[i] <- id_list[[ensembl_id]]
} else{
rnaname[i] <- ensembl_id
}
}
rnaname[rnaname == ""] <- NA
rownames(rna) <- rnaname
rm(ensembl, gene_ids, id_list, mart, ensembl_id, i, rnaname)
write.csv(rna, "C:/Users/rthalla/OneDrive - Loyola University Chicago/Zhang Lab/RNASeq/Cite-seq/GSE145491/rnacd150esam_genename.csv")
seurat_object <- FindVariableFeatures(object = seurat_object)
seurat_object <- ScaleData(object = seurat_object)
seurat_object <- RunPCA(object =seurat_object)
seurat_object <- FindNeighbors(object =seurat_object, dims = 1:30)
seurat_object <- FindClusters(object =seurat_object)
seurat_object <- RunUMAP(object =seurat_object, dims = 1:30)
DimPlot(seurat_object)
DefaultAssay(seurat_object) <- "ADT"
p1 <- FeaturePlot(seurat_object, "ESAM", cols = c("lightgrey", "darkgreen")) + ggtitle("ESAM protein")
DefaultAssay(seurat_object) <- "RNA"
p2 <- FeaturePlot(seurat_object, "ENSMUSG00000001946") + ggtitle("ESAM RNA")
# place plots side-by-side
p1 | p2
